{% extends "::layout.html.twig" %}

{% block title %}{{parent()}}  - Liste profils{% endblock %}

{% block stylesheets %}
    {{parent()}} {#<link rel="stylesheet" type="text/css" href="{{ asset('css/page/login.css') }}" />#}
{% endblock %}
{% block file_arriane %}
     <div class="fond-fil-ariane" >
                    <div class="zone-fil-ariane" style="background:rgba(0,0,0,0.4); width: 100%; height : 0px;padding-top: 0px;color: #fff;">
                        <div class="row" style="background:rgba(0,0,0,0.3)">
                            <div class="col-xs-7" >
                               <h1> Liste des profils</h1>
                            </div>
                            <div class="col-xs-5" style="margin-top: 15px; ">
                               <span class="fil-1"> Accueil</span> > <span class="fil-2">Gestion des profils</span> ><span class="fil-3"> Liste </span>
                            </div>
                        </div>
                    </div>
		</div>           
{% endblock  %}

{% block body %}



        {% for contenu in app.session.getflashbag.get('profil.ajout.success')%}
            {% if loop.index == 0%}
              
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    {% endif%}
                    <div class="text-center alert alert-success fade in ">{{contenu}}</div>
                    {% if loop.index == 0%} 
                    </div>
               
            {% endif%}
        {% endfor%}
        {% for contenu in app.session.getflashbag.get('profil.modifier.success')%}
            {% if loop.index == 0%}
                
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    {% endif%}
                    <div class="text-center alert alert-success fade in">{{contenu}}</div>
                    {% if loop.index == 0%} 
                    </div>
             
            {% endif%}
        {% endfor%}

        {#<div style="margin-bottom: 10px" class="row ">
            {% if  isMaintenance(sessionData.codeProfil)  %}
                <div class="col-lg-1 col-md-1 col-sm-3 col-xs-3">
                    <a class=" " href="{{path('app_admin_profil_ajout')}} " id="">
                        <img src="{{asset('img/ico/ajouter.png')}}" id="btnNew" class="tooltipGobi v_pointer_cursor "  title="Ajouter"/>
                    </a>
                </div>
           
 {% endif %}
            <div class="col-lg-1 col-md-1 col-sm-3 col-xs-3 ">
                <img src="{{asset('img/ico/valider.png')}}" id="btnActive"  class="tooltipGobi v_pointer_cursor btnAction" btnActionVal="1" title="Activer"/>
            </div>
            <div class="col-lg-1 col-md-1 col-sm-3 col-xs-3  ">
                <img src="{{asset('img/ico/icon-48-deny.png')}}" id="btnDesactiver"  class="tooltipGobi v_pointer_cursor btnAction" btnActionVal="0" title="Désactiver"/>
            </div>
            <div class="col-lg-1 col-md-1 col-sm-3 col-xs-3  ">
                <img src="{{asset('img/ico/supprimer.png')}}" id="btnSupprimer"  class="tooltipGobi v_pointer_cursor btnAction" btnActionVal="2" title="Supprimer"/>
            </div>
        </div>#}
<div class="row" style="margin-bottom:10px;margin-top: -5px; ">
    <div class="col-lg-9">
    </div>    
    <div class="btn-toolbar col-lg-3">
        <div aria-label="First group" role="group" class="btn-group">
              {#  <a class=" " href="{{path('app_admin_eleves')}}" id="" title="Afficher tous les clients">
                    <button class="circle-social" type="button">
                        <i class="fa fa-list"></i>
                    </button>
                </a>#}
               {% if  isMaintenance(sessionData.codeProfil)  %}
                        <a class="circle-social btn  btn-default " href="{{path('app_admin_profil_ajout')}} " id="" title="Ajouter">                           
                                <i class="fa fa-plus"></i>                            
                        </a>
                    {% endif %}
            <button id="btnActive" class="circle-social btnAction btn btn-default" btnActionVal="1" type="button" title="Activer">
                <i class="fa fa-check"></i>
            </button>
            <button id="btnActive" class="circle-social btnAction btn  btn-default" btnActionVal="0" type="button" title="Désactiver">
                <i class="fa fa-minus"></i>
            </button>
            <button id="btnSupprimer" class="circle-social btnAction btn  btn-default" btnActionVal="2" type="button" title="Supprimer">
                <i class="fa fa-trash-o"></i>
            </button>

        </div>
    </div>
</div>
<div class="row" style="margin:0px -17px; " >
            {#<header class="panel-heading title-panel">
                <i class="fa fa-table "></i> <span class="margin-right-20px "> Liste des Elèves {% if idProfil > 0 %} du profil {{profil.nom}} {% endif %} </span>
            </header> #}

    <div class="col-md-2 " style="margin-top: -50px;">
        <div class="grid-inbox">
            <div class="inbox-top">
                {#<div class="inbox-img">
                    <img src="images/1.jpg" class="img-responsive" alt="">
                </div>#}
                <div class="inbox-text">
                    {#<i class="fa fa-chevron-up"></i>#}<h5>Statistiques </h5>
                  
                </div>
                <div class="clearfix"></div>
            </div>
            <a href="#" class="compose" data-toggle="modal" data-target="#myModal1">Tous les stats</a>
           {# <div class="inbox-bottom">
                <h4>Général</h4>
                <ul>
                    <li><a href="#"> Total. 1 000 000</a></li>
                    <li><a href="#"><i class="glyphicon glyphicon-send" aria-hidden="true"></i> Fille.  0 000 000</a></li>
                    <li><a href="#">{#<i class="glyphicon glyphicon-bookmark" aria-hidden="true"></i> Garcon.  0 000 000</a></li>
                   {# <li><a href=""><i class="glyphicon glyphicon-new-window" aria-hidden="true"></i> Drafts </a></li>
                    <li><a href=""><i class="glyphicon glyphicon-trash" aria-hidden="true"></i>  Trash</a></li>
                </ul>
            </div>
            #}
          {#  <div class="online">
                <h4>BUDDY ONLINE</h4>
                <ul>
                    <li><a href=""><i class="span"></i> Jhone Doe <p>I do not think</p> </a></li>
                    <li><a href=""><i class="span1"></i> Sumon <p>Busy with coding</p> </a></li>
                    <li><a href=""><i class="span2"></i> Tawseef <p>I out of control</p> </a></li>
                    <li><a href=""><i class="span3"></i> Anjelina Joli <p>I do not think</p> </a></li>
                </ul>
            </div>#}
        </div>
    </div>
    <div class="col-md-10 " >
                <div class="panel panel-white">
  {#                  <header class="panel-heading">
                        <i class="fa fa-list"></i> Liste des profils
                    </header>#}
                    <div class="panel-body">
                        <table class="table table-striped table-advance table-hover">
                            <tbody>
                                <tr class="label-info ">
                                    <th>
                                        <input type="checkbox" class="checkAll checkbox tooltipGobi" name="checkAll" title="Tout cocher/Décocher"/>
                                    </th>
                                    <th>Type</th>
                                    <th>Nom</th>
                                    <th>Description</th>
                                    <th style="">Etat</th>
                                    <th><i class="fa fa-cog"></i> Action</th>
                                </tr>

                                {% for t in profils %}
                                    <tr>
                                        <td>
                                            {% if not isMaintenance(t.code) %}
                                                <input type="checkbox" class="checkOne checkbox " sId="{{t.id}}"/>
                                            {% endif%}
                                        </td>
                                        <td>{{getLibelleTypeProfil(t.typeProfil)}}</td>
                                        <td>{{t.nom}}</td>
                                        <td>{{t.description}}
                                        </td>
                                        <td>
                                            {% if isTypeEtatActif(t.etat)%}
                                                <img src="{{asset('img/ico/valider.png')}}"  style="width: 20px" title="Actif"/>
                                            {% else%}
                                                <img src="{{asset('img/ico/icon-48-deny.png')}}" style="width: 20px" title="Inactif"/>
                                            {% endif%}
                                        </td>
                                        <td>
                                            <div class="btn-group">
                                                {% if not isMaintenance(t.code)  %}
                                                    <a href="{{path('app_admin_profil_modifier', {'idProfil' : t.id})}}" class="btn btn-mini btn-info btnEdit tooltipGobi" title="Modifier  {{t.nom}}">
                                                        <i class="fa fa-edit"></i>
                                                    </a>
                                                    <a target="_blank" href="{{path('app_admin_profil_droits', {'idProfil' : t.id})}}" class="btn   btn-mini btn-success tooltipGobi" title="Attribution de droits ( {{t.nom}} )">
                                                        <i class="fa fa-cog"></i>
                                                    </a> 
                                                {% endif %}
                                                {#{% if not isMaintenance(sessionData.codeProfil)  %}
                                                    {% if isTypeProfilUtilisateur(t.typeProfil) %}
                                                        <a target="_blank" href="{{path('app_admin_users', {'idProfil' : t.id})}}" class="btn  btn-mini   btn-default tooltipGobi" title="Voir utilisateurs du profil ( {{t.nom}} )">
                                                            <i class="fa fa-user"></i>
                                                        </a>
                                                    {% else %}
                                                        <a target="_blank" href="{{path('app_admin_abonnes', {'idProfil' : t.id})}}" class="btn  btn-mini   btn-default tooltipGobi" title="Voir utilisateurs du profil ( {{t.nom}} )">
                                                            <i class="fa fa-user"></i>
                                                        </a>
                                                    {% endif %}
                                                {% endif %}#}

                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}


                            </tbody>
                        </table>
                       {# <button class="generePoll" >Pull</button>#}
                        
                    </div>
                </div>
            </div>
            </div>
        

{% endblock %}
{% block scripts %}
    {{parent()}}
    <script type="text/javascript">
        $(document).ready(function () {
            toutDecocher('checkOne');
            $('#btnNew').click(function () {
                $('#formNew').toggle(500);
            });
            $('#resetNew').click(function () {
                $('#formNew').toggle(500);
            });
            $('.btnEdit').click(function () {
                $(this).parent('td').parent('tr').children('td').eq(2).children('.formEdit').toggle(500);
            });
            $('.checkAll').change(function () {
                if ($(this).is(':checked')) {
                    toutCocher('checkOne');
                } else {
                    toutDecocher('checkOne');
                }
            });
            $('.btnAction').click(function () {
                var type = parseInt($(this).attr('btnActionVal'));
                var tab = getCheckedId('checkOne', 'sId', true);
                var nb = tab.length;
                if (nb === 0) {
                    var msg = "Veillez sélectionner les profils à activer";
                    if (type === 0) {
                        msg = "Veillez sélectionner les profils à désactiver";
                    }
                    if (type === 2) {
                        msg = "Veillez sélectionner les profil à supprimer";
                    }
                    error_message('Attention', msg);
                } else {
                    msg = "Confirmer l'activation des profils sélectionnés";
                    if (type === 0) {
                        msg = "Confirmer la désactivation  des profils sélectionnés";
                    }
                    if (type === 2) {
                        msg = "Confirmer la suppression des profils sélectionnés";
                    }
                    afficherConfirmationSetEtat(msg, tab, type);
                }
            });


        });

        function afficherConfirmationSetEtat(msg, tab, type) {
            $('<div id="msg" title="Confirmation"><p> ' + msg + '</p></div>').dialog({
                hide: {
                    // effect: "explode"isEmetteur,
                    duration: 500
                },
                modal: true,
                autoOpen: false,
                buttons: {
                    " Confirmer ": function () {
                        setEtatTypeuser(tab, type);
                        $(this).dialog('close');
                    },
                    " Annuler ": function () {
                        $(this).dialog('close');
                    }

                }

            }).dialog('open');
        }

        function setEtatTypeuser(tabIds, etat) {

            var ajaxId = prepareAjaxData(tabIds);
            $.ajax({
                dataType: 'json',
                type: 'POST',
                url: "{{ path('app_admin_profil_set_etat') }}",
                data: 'sId=' + ajaxId + '&etat=' + etat,
                beforeSend: function () {
                    onLoadGobi();
                },
                success: function (rep) {
                    closeOnLoadGobi();
                    if (rep['etat']) {
                        window.location.reload();
                    } else {
                        error_message('Erreur', rep['msg']);
                    }
                },
                complete: function () {
                    closeOnLoadGobi();
                }

            });
        }
        
        $('.generePoll').click(function () {
        
            for (var pas = 0; pas < 100; pas++){                
               for (var pas = 0; pas < 100; pas++){
                        $.ajax({
                        dataType: "script",
                        type: 'POST',
                        url: "http://www.yfmghana.com/contest/17908/enterContestSubmit",
                        data: 'first_name=' + 'fessou' + '&last_name=' + 'Lawson' + '&email=' + 'Lawson@yahoo.fr'+'&_email=' + 'Lawson@yahoo.fr'+'&disable_email=' + 0+'&country=' + 'GH'+'&region=' + 'Central Region'+'&gender='+'male'+'&phone='+'90000000'+'&birthdate='+'1990-5-29'+'field-36687='+0+'&rules=1' ,
                        beforeSend: function () {
                            //window.open("http://www.yfmghana.com/polls/ajaxVote?poll=15597&select=0");
                        },
                        success: function (rep) {
                           // alert('tester');
                        },
                        complete: function () {

                        }

                    });
                
            }
                
            }
            });
       
    </script>
{% endblock %}
